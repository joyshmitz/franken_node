{
  "description": "Golden test vectors for BOCPD regime detector (bd-3u4)",
  "algorithm": "Adams & MacKay 2007 \u2014 Bayesian Online Changepoint Detection",
  "vectors": [
    {
      "name": "stable_gaussian_no_shift",
      "model": "Gaussian",
      "hazard": {
        "type": "Constant",
        "lambda": 200.0
      },
      "prior": {
        "mu0": 10.0,
        "kappa0": 1.0,
        "alpha0": 1.0,
        "beta0": 1.0
      },
      "observations": [
        10.0,
        10.1,
        9.9,
        10.0,
        10.2,
        9.8,
        10.0,
        10.1,
        9.9,
        10.0
      ],
      "expected_changepoints": 0,
      "description": "Stable stream around mean=10, no regime shift expected"
    },
    {
      "name": "gaussian_mean_shift",
      "model": "Gaussian",
      "hazard": {
        "type": "Constant",
        "lambda": 50.0
      },
      "prior": {
        "mu0": 10.0,
        "kappa0": 0.1,
        "alpha0": 1.0,
        "beta0": 1.0
      },
      "config": {
        "changepoint_threshold": 0.3,
        "min_run_length": 5
      },
      "observations_regime_1": [
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0,
        10.0
      ],
      "observations_regime_2": [
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0,
        50.0
      ],
      "expected_changepoints_gte": 1,
      "description": "Mean shifts from 10 to 50, should detect at least one changepoint"
    },
    {
      "name": "poisson_rate_shift",
      "model": "Poisson",
      "hazard": {
        "type": "Constant",
        "lambda": 50.0
      },
      "prior": {
        "alpha0": 1.0,
        "beta0": 1.0
      },
      "config": {
        "changepoint_threshold": 0.3,
        "min_run_length": 5
      },
      "observations_regime_1": [
        2,
        3,
        1,
        2,
        3,
        2,
        1,
        3,
        2,
        2,
        1,
        3,
        2,
        2,
        3,
        1,
        2,
        3,
        2,
        1,
        2,
        3,
        2,
        1,
        3,
        2,
        2,
        1,
        3,
        2
      ],
      "observations_regime_2": [
        20,
        22,
        18,
        21,
        19,
        20,
        22,
        18,
        21,
        20,
        19,
        22,
        20,
        21,
        18,
        20,
        22,
        19,
        21,
        20,
        20,
        22,
        18,
        21,
        19,
        20,
        22,
        18,
        21,
        20
      ],
      "expected_changepoints_gte": 1,
      "description": "Poisson rate shifts from ~2 to ~20, should detect changepoint"
    },
    {
      "name": "correlation_two_streams",
      "streams": [
        "latency",
        "error_rate"
      ],
      "correlation_window_secs": 60,
      "shifts": [
        {
          "stream": "latency",
          "timestamp": 1000,
          "confidence": 0.85
        },
        {
          "stream": "error_rate",
          "timestamp": 1030,
          "confidence": 0.9
        }
      ],
      "expected_correlated": true,
      "description": "Two streams shifting within 60s window should correlate"
    },
    {
      "name": "min_run_length_suppression",
      "model": "Gaussian",
      "hazard": {
        "type": "Constant",
        "lambda": 10.0
      },
      "config": {
        "changepoint_threshold": 0.01,
        "min_run_length": 100
      },
      "observations": [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        100.0,
        100.0,
        100.0,
        100.0,
        100.0,
        100.0,
        100.0,
        100.0,
        100.0,
        100.0
      ],
      "expected_changepoints": 0,
      "description": "min_run_length=100 suppresses all signals for 20-observation stream"
    },
    {
      "name": "bounded_truncation",
      "model": "Gaussian",
      "config": {
        "max_run_length": 50
      },
      "total_observations": 100,
      "expected_max_probs_len": 52,
      "description": "Run-length distribution truncated at max_run_length=50"
    }
  ],
  "invariants": {
    "INV-BCP-POSTERIOR": "Posterior run-length distribution sums to 1.0 (within 1e-6) after every update",
    "INV-BCP-MONOTONIC": "Run-length counts monotonically increase within a regime",
    "INV-BCP-BOUNDED": "Run-length distribution truncated at max_run_length",
    "INV-BCP-MIN-RUN": "Changepoints only signaled after min_run_length observations"
  }
}